{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\n// Описаний у документації\nimport iziToast from 'izitoast';\n// Додатковий імпорт стилів\nimport 'izitoast/dist/css/iziToast.min.css';\n// Описаний у документації\nimport SimpleLightbox from 'simplelightbox';\n// Додатковий імпорт стилів\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst API_KEY = '41949985-8da78252305a4c2e980ced1f3';\nconst searchFormEl = document.querySelector('.search-form');\nconst gallery = document.querySelector('.gallery');\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst loader = document.querySelector('.loader');\nconst loadMoreButton = document.querySelector('.load-more');\nlet currentPage = 1;\nlet totalHits = 0;\nlet searchQuery = '';\nlet imagesLoaded = 0;\n\nloader.style.display = 'none';\nloadMoreButton.classList.remove('visible');\nsearchFormEl.addEventListener('submit', handleFormSubmit);\nloadMoreButton.addEventListener('click', loadMoreImages);\n\nasync function handleFormSubmit(event) {\n  event.preventDefault();\n  searchQuery = event.target.querySelector('.search-input').value.trim();\nif (!searchQuery) {\n  showWarningToast('Please enter image name!');\n  return;\n}\n\nclearGallery();\nshowLoader();\nhideLoadMoreButton();\n\ntry {\n  const response = await axios.get('https://pixabay.com/api/', {\n    params: {\n      key: API_KEY,\n      per_page: 40,\n      safesearch: true,\n      page: currentPage,\n      orientation: 'horizontal',\n      image_type: 'photo',\n      q: searchQuery,\n    },\n  });\nhideLoader();\n\nconst data = response.data;\nif (data.hits.length === 0) {\n  showErrorToast('Sorry, there are no images matching your search query. Please try again!');\n  return;\n}\n\ntotalHits = data.totalHits;\nimagesLoaded = data.hits.length;\nrenderImages(data.hits);\nlightbox.refresh();\n\nshowInfoToast(`We found ${totalHits} images.`);\n\nif (totalHits > 40) {\n  showLoadMoreButton();\n}\n\n} catch (error) {\n  console.error('Error fetching images:', error);\n  hideLoader();\n  showErrorToast('Failed to fetch images. Please try again later.');\n}\n}\n\nfunction renderImages(images) {\n  const fragment = document.createDocumentFragment();\n\nimages.forEach(image => {\n  const imageCardElement = createImageCard(image);\n  fragment.appendChild(imageCardElement);\n});\n\ngallery.appendChild(fragment);\n}\n\nfunction createImageCard(image) {\n  const imageCardElement = document.createElement('div');\n  imageCardElement.classList.add('card');\n\n  imageCardElement.innerHTML = `\n    <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n    <img class=\"card-image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\">\n    </a>\n    <div class=\"card-info\">\n      <p class=\"card-text\"><b>Likes:</b> ${image.likes}</p>\n      <p class=\"card-text\"><b>Views:</b> ${image.views}</p>\n      <p class=\"card-text\"><b>Comments:</b> ${image.comments}</p>\n      <p class=\"card-text\"><b>Downloads:</b> ${image.downloads}</p>\n    </div>\n  `;\n\n  return imageCardElement;\n}\n\nfunction clearGallery() {\n  gallery.innerHTML = '';\n  currentPage = 1;\n  hideLoadMoreButton();\n}\n\nasync function loadMoreImages() {\n  showLoader();\n  hideLoadMoreButton();\n\n  try {\n    const response = await axios.get('https://pixabay.com/api/', {\n      params: {\n        key: API_KEY,\n        safesearch: true,\n        per_page: 40,\n        page: currentPage + 1,\n        orientation: 'horizontal',\n        image_type: 'photo',\n        q: searchQuery,\n      },\n    });\n    \n    hideLoader();\n\n    const data = response.data;\n\n    if (data.hits.length === 0) {\n      return;\n    }\n\n    currentPage++;\n\n    if (imagesLoaded + data.hits.length > totalHits) {\n      data.hits = data.hits.slice(0, totalHits - imagesLoaded);\n    }\n\n    imagesLoaded += data.hits.length;\n    renderImages(data.hits);\n    lightbox.refresh();\n\n    if (imagesLoaded >= totalHits) {\n      hideLoadMoreButton();\n      showInfoToast(`We're sorry, but you've reached the end of search results.`);\n    } else {\n      showLoadMoreButton();\n    }\n\n    const cards = document.querySelectorAll('.card');\n    const newImages = Array.from(cards).slice(-40);\n    if (newImages.length > 0) {\n      const firstNewImage = newImages[0];\n\n      firstNewImage.scrollIntoView({\n        behavior: 'smooth',\n        block: 'start',\n      });\n    }\n  } catch (error) {\n    console.error('Error fetching more images:', error);\n    hideLoader();\n    showErrorToast('Failed to fetch more images. Please try again later.');\n  }\n}\n\nconst showLoader = () => {\n  loader.style.display = 'block';\n};\nconst hideLoader = () => {\n  loader.style.display = 'none';\n};\nconst showLoadMoreButton = () => {\n  loadMoreButton.style.display = 'block';\n};\nconst hideLoadMoreButton = () => {\n  loadMoreButton.style.display = 'none';\n};\nconst showWarningToast = (message) => {\n  iziToast.warning({\n    title: 'Warning!',\n    message: message,\n    position: 'topRight',\n  });\n};\n\nconst showErrorToast = (message) => {\n  iziToast.error({\n    message: message,\n    position: 'topRight',\n  });\n};\n\nconst showInfoToast = (message) => {\n  iziToast.info({\n    message: message,\n    position: 'topRight',\n  });\n};\n"],"names":["API_KEY","searchFormEl","gallery","lightbox","SimpleLightbox","loader","loadMoreButton","currentPage","totalHits","searchQuery","imagesLoaded","handleFormSubmit","loadMoreImages","event","showWarningToast","clearGallery","showLoader","hideLoadMoreButton","response","axios","hideLoader","data","showErrorToast","renderImages","showInfoToast","showLoadMoreButton","error","images","fragment","image","imageCardElement","createImageCard","cards","newImages","message","iziToast"],"mappings":"owBAYA,MAAMA,EAAU,qCACVC,EAAe,SAAS,cAAc,cAAc,EACpDC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,GAChB,CAAC,EAEKC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAiB,SAAS,cAAc,YAAY,EAC1D,IAAIC,EAAc,EACdC,EAAY,EACZC,EAAc,GACdC,EAAe,EAEnBL,EAAO,MAAM,QAAU,OACvBC,EAAe,UAAU,OAAO,SAAS,EACzCL,EAAa,iBAAiB,SAAUU,CAAgB,EACxDL,EAAe,iBAAiB,QAASM,CAAc,EAEvD,eAAeD,EAAiBE,EAAO,CAGvC,GAFEA,EAAM,eAAc,EACpBJ,EAAcI,EAAM,OAAO,cAAc,eAAe,EAAE,MAAM,OAC9D,CAACJ,EAAa,CAChBK,EAAiB,0BAA0B,EAC3C,MACF,CAEAC,IACAC,IACAC,IAEA,GAAI,CACF,MAAMC,EAAW,MAAMC,EAAM,IAAI,2BAA4B,CAC3D,OAAQ,CACN,IAAKnB,EACL,SAAU,GACV,WAAY,GACZ,KAAMO,EACN,YAAa,aACb,WAAY,QACZ,EAAGE,CACJ,CACL,CAAG,EACHW,IAEA,MAAMC,EAAOH,EAAS,KACtB,GAAIG,EAAK,KAAK,SAAW,EAAG,CAC1BC,EAAe,0EAA0E,EACzF,MACF,CAEAd,EAAYa,EAAK,UACjBX,EAAeW,EAAK,KAAK,OACzBE,EAAaF,EAAK,IAAI,EACtBlB,EAAS,QAAO,EAEhBqB,EAAc,YAAYhB,CAAS,UAAU,EAEzCA,EAAY,IACdiB,GAGF,OAASC,EAAO,CACd,QAAQ,MAAM,yBAA0BA,CAAK,EAC7CN,IACAE,EAAe,iDAAiD,CAClE,CACA,CAEA,SAASC,EAAaI,EAAQ,CAC5B,MAAMC,EAAW,SAAS,yBAE5BD,EAAO,QAAQE,GAAS,CACtB,MAAMC,EAAmBC,EAAgBF,CAAK,EAC9CD,EAAS,YAAYE,CAAgB,CACvC,CAAC,EAED5B,EAAQ,YAAY0B,CAAQ,CAC5B,CAEA,SAASG,EAAgBF,EAAO,CAC9B,MAAMC,EAAmB,SAAS,cAAc,KAAK,EACrD,OAAAA,EAAiB,UAAU,IAAI,MAAM,EAErCA,EAAiB,UAAY;AAAA,oCACKD,EAAM,aAAa;AAAA,mCACpBA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA;AAAA,2CAG9BA,EAAM,KAAK;AAAA,2CACXA,EAAM,KAAK;AAAA,8CACRA,EAAM,QAAQ;AAAA,+CACbA,EAAM,SAAS;AAAA;AAAA,IAIrDC,CACT,CAEA,SAASf,GAAe,CACtBb,EAAQ,UAAY,GACpBK,EAAc,EACdU,GACF,CAEA,eAAeL,GAAiB,CAC9BI,IACAC,IAEA,GAAI,CACF,MAAMC,EAAW,MAAMC,EAAM,IAAI,2BAA4B,CAC3D,OAAQ,CACN,IAAKnB,EACL,WAAY,GACZ,SAAU,GACV,KAAMO,EAAc,EACpB,YAAa,aACb,WAAY,QACZ,EAAGE,CACJ,CACP,CAAK,EAEDW,IAEA,MAAMC,EAAOH,EAAS,KAEtB,GAAIG,EAAK,KAAK,SAAW,EACvB,OAGFd,IAEIG,EAAeW,EAAK,KAAK,OAASb,IACpCa,EAAK,KAAOA,EAAK,KAAK,MAAM,EAAGb,EAAYE,CAAY,GAGzDA,GAAgBW,EAAK,KAAK,OAC1BE,EAAaF,EAAK,IAAI,EACtBlB,EAAS,QAAO,EAEZO,GAAgBF,GAClBS,IACAO,EAAc,4DAA4D,GAE1EC,IAGF,MAAMO,EAAQ,SAAS,iBAAiB,OAAO,EACzCC,EAAY,MAAM,KAAKD,CAAK,EAAE,MAAM,GAAG,EACzCC,EAAU,OAAS,GACCA,EAAU,CAAC,EAEnB,eAAe,CAC3B,SAAU,SACV,MAAO,OACf,CAAO,CAEJ,OAAQP,EAAO,CACd,QAAQ,MAAM,8BAA+BA,CAAK,EAClDN,IACAE,EAAe,sDAAsD,CACtE,CACH,CAEA,MAAMN,EAAa,IAAM,CACvBX,EAAO,MAAM,QAAU,OACzB,EACMe,EAAa,IAAM,CACvBf,EAAO,MAAM,QAAU,MACzB,EACMoB,EAAqB,IAAM,CAC/BnB,EAAe,MAAM,QAAU,OACjC,EACMW,EAAqB,IAAM,CAC/BX,EAAe,MAAM,QAAU,MACjC,EACMQ,EAAoBoB,GAAY,CACpCC,EAAS,QAAQ,CACf,MAAO,WACP,QAASD,EACT,SAAU,UACd,CAAG,CACH,EAEMZ,EAAkBY,GAAY,CAClCC,EAAS,MAAM,CACb,QAASD,EACT,SAAU,UACd,CAAG,CACH,EAEMV,EAAiBU,GAAY,CACjCC,EAAS,KAAK,CACZ,QAASD,EACT,SAAU,UACd,CAAG,CACH"}